<!DOCTYPE html>
<html lang = "en">
    <!-- optimisation for search engines-->
    <head>
        <meta charset = "UTF-8" >
        <meta name = "description" content = "Some questions about webbrowsers">
        <meta name = "keywords" content = "Questions, Ranking webbrowser statistics, Questions, Multiple choice, Open question">
        <meta name = "viewport" content = "width=device-width, initial-scale=1.0">

        <!-- connection to external css sheet -->
        <link rel = "stylesheet" href = "style.css">
        
        <!-- name  and icon of the browser tab -->
        <title>Webipedia</title>
        <link rel="icon" href="img/browser-icon.ico">
    </head>

    <!-- declarations of content -->
    <body>
        <!-- horizontal navigation bar directs the user to the other webpages of the website -->
        <nav>
            <ul>
                <li><a class = "active" href = "main.html">Home</a></li>
                <li><a href = "page1-google-chrome.html">Google Chrome</a></li>
                <li><a href = "page2-mozilla-firefox.html">Mozilla Firefox</a></li>
                <li><a href = "page3-internet-explorer.html">Internet Explorer</a></li>
                <li><a href = "page4-safari.html">Safari</a></li>
                <li><a href = "assessment.html">WebiQuiz</a></li>
            </ul>
        </nav>

        <!-- article contains the content of the webpage -->
        <article class = "webpage-content">
            <!-- The header of each webpage -->
            <header>
                <h1>WebiQuiz</h1>
                <p>Made by: Nathan van de Kolk, Joran van de Kolk, Do Toan Nguyen</p>
            </header>

            <div class = "webiQuiz">
                <section class = "webpage-content__section"></section>
            </div>

        </article>

        <script>
            var questionSection = document.querySelector(".webiQuiz .webpage-content__section");

            class excercise
            {
                constructor(question, answers)
                {
                    this.question = question;
                    this.correctAnswer = answers[0];
                    this.answers = answers.slice();//slice so it is an independent copy, not just a reference

                    //Fisher-Yates shuffle, source: https://www.w3schools.com/js/js_array_sort.asp
                    for (let i = this.answers.length -1; i > 0; i--) {
                    let j = Math.floor(Math.random() * i)
                    let k = this.answers[i];
                    this.answers[i] = this.answers[j];
                    this.answers[j] = k;
                    } 
                }

                renderExcercise(i)
                {
                    var questionHeader = document.createElement("h2");
                    var questionSubSection = document.createElement("section");
                    questionSubSection.className = "webpage-content__section__subsection";
                    var questionContainer = document.createElement("h6");

                    questionHeader.appendChild(document.createTextNode("Question" + (i+1)));
                    questionContainer.appendChild(document.createTextNode(this.question))

                    questionSubSection.appendChild(questionContainer);
                    
                    questionSection.appendChild(questionHeader);
                    questionSection.appendChild(questionSubSection);
                }
            }

            class multipleChoice extends excercise
            {
                constructor(question, answers)
                {
                    super(question, answers);
                }

                renderExcercise(i)
                {
                    super.renderExcercise(i);
                    var questionSubSection = document.getElementsByClassName("webpage-content__section__subsection")[i];
                    for(let k = 0; k < this.answers.length; k++)
                    {
                        var answersContainer = document.createElement("input");
                        answersContainer.type = "radio";
                        answersContainer.name = "answersOfQ" + i;
                        answersContainer.value = this.answers[k];
                        var radioLabel = document.createElement("label");
                        radioLabel.for = answersContainer.value;
                        radioLabel.appendChild(document.createTextNode(this.answers[k]));

                        questionSubSection.appendChild(answersContainer);
                        questionSubSection.appendChild(radioLabel);
                        if(k < this.answers.length - 1)
                            questionSubSection.appendChild(document.createElement("br"));
                    }
                }

                checkAnswer = i => 
                {
                    for(var answer of document.getElementsByName("answersOfQ" + i))
                        if(answer.value == this.correctAnswer) return answer.checked;
                }
            }

            class multiChoice extends excercise
            {
                constructor(question, answers, amount)
                {
                    super(question, answers);
                    this.amount = amount;
                    this.correctAnswer = answers.slice(0, amount);
                }

                renderExcercise(i)
                {
                    super.renderExcercise(i);
                    var questionSubSection = document.getElementsByClassName("webpage-content__section__subsection")[i];
                    for(let k = 0; k < this.answers.length; k++)
                    {
                        var answersContainer = document.createElement("input");
                        answersContainer.type = "checkbox";
                        answersContainer.name = "answersOfQ" + i;
                        answersContainer.value = this.answers[k];
                        var radioLabel = document.createElement("label");
                        radioLabel.for = answersContainer.value;
                        radioLabel.appendChild(document.createTextNode(this.answers[k]));

                        questionSubSection.appendChild(answersContainer);
                        questionSubSection.appendChild(radioLabel);
                        if(k < this.answers.length - 1)
                            questionSubSection.appendChild(document.createElement("br"));
                    }
                }

                checkAnswer = i =>
                {
                    var answerCorrect = true;
                    for(let answer of document.getElementsByName("answersOfQ" + i))
                        answerCorrect = answerCorrect && ((this.correctAnswer.indexOf(answer.value) != -1) == answer.checked);
                    return answerCorrect;
                }
            }

            class open extends excercise
            {
                constructor(question, answers)
                {
                    super(question, answers);
                }

                renderExcercise(i)
                {
                    super.renderExcercise(i);
                    var questionSubSection = document.getElementsByClassName("webpage-content__section__subsection")[i];
                    var answersContainer = document.createElement("input");
                    answersContainer.type = "text";
                    answersContainer.name = "answersOfQ" + i;

                    questionSubSection.appendChild(answersContainer);
                }

                checkAnswer = i => this.answers.indexOf(document.getElementsByName("answersOfQ" + i)[0].value) >= 0;
            }

            class ordering extends excercise
            {
                constructor(question, answers)
                {
                    super(question, answers);
                    this.correctAnswer = answers.slice();
                }

                renderExcercise(i)
                {
                    super.renderExcercise(i);
                    var questionSubSection = document.getElementsByClassName("webpage-content__section__subsection")[i];
                    for(let k = 0; k < this.answers.length; k++)
                    {
                        var orderLabel = document.createElement("label");
                        orderLabel.for = this.answers[k];
                        orderLabel.id = "q" + i + "label" + k;
                        orderLabel.appendChild(document.createTextNode(this.answers[k]));
                        questionSubSection.appendChild(orderLabel);

                        if(k > 0)
                        {
                            var answersContainer = document.createElement("input");
                            answersContainer.type = "button";
                            answersContainer.value = "^";
                            answersContainer.addEventListener("click", function() { questions[i].changeOrder(k - 1, i); });
                            questionSubSection.appendChild(answersContainer);
                        }

                        if(k < this.answers.length - 1)
                        {
                            var answersContainer = document.createElement("input");
                            answersContainer.type = "button";
                            answersContainer.value = "v";
                            answersContainer.addEventListener("click", function() { questions[i].changeOrder(k, i); });
                            questionSubSection.appendChild(answersContainer);
                            questionSubSection.appendChild(document.createElement("br"));
                        }
                    }
                }

                changeOrder = (i, j) =>
                {
                    this.answers.splice(i, 2, this.answers[i + 1], this.answers[i]);
                    var elem = document.getElementById("q" + j + "label" + i);
                    elem.replaceChild(document.createTextNode(this.answers[i]), elem.childNodes[0]);
                    elem = document.getElementById("q" + j + "label" + (i + 1));
                    elem.replaceChild(document.createTextNode(this.answers[i + 1]), elem.childNodes[0]);
                }

                checkAnswer = () =>
                {
                    var answerCorrect = true;
                    for (let i = 0; i < this.answers.length && answerCorrect; i++)
                    {
                        answerCorrect = this.answers[i] == this.correctAnswer[i];
                    }
                    return answerCorrect;
                }
            }

            var questions = 
                [
                    new ordering(
                        "What are the top 4 leading web browsers in order of popularity on desktop as of January 2021?",
                        [
                            "Google Chrome",
                            "Safari",
                            "Mozilla Firefox",
                            "Microsoft Edge"
                        ]
                    ),
                    new open(
                        "What was the original name of Firefox?",
                        [
                            "Phoenix",
                            "Foenix",
                            "Poenix"
                        ]
                    ),
                    new multipleChoice(
                        "How many versions of Internet Explorer were released between 1995 and 2011?",
                        [
                            "10",
                            "8",
                            "11",
                            "9",
                            "7"
                        ]
                    ),
                    new multiChoice(
                        "Which of the following are web browsers?(multiple options possible)",
                        [
                            "Firefox",
                            "Opera",
                            "Mosaic",
                            "DuckDuckGo",
                            "Facebook",
                            "Google",
                            "Yahoo",
                            "Hyves"
                        ],
                        3
                    )
                ]

            renderQuiz = () =>
            {
                for(let i = 0; i < questions.length; i++)
                {
                    questions[i].renderExcercise(i);
                }

                var resultHeader = document.createElement("h2");
                var resultSection = document.createElement("section");
                resultSection.className = "webpage-content__section__subsection";
                resultHeader.appendChild(document.createTextNode("Results"));

                var checkButton = document.createElement("input");
                checkButton.type = "button";
                checkButton.value = "Check Answers";
                checkButton.addEventListener("click", checkAnswers);

                questionSection.appendChild(resultHeader);
                resultSection.appendChild(checkButton);
                resultSection.appendChild(document.createElement("br"));
                resultSection.appendChild(document.createTextNode("Your results will be displayed here."));


                questionSection.appendChild(resultSection);

            }
            
            checkAnswers = () =>
            {
                var quizResults = [];
                for(let i = 0; i < questions.length; i++)
                {
                    quizResults.push(questions[i].checkAnswer(i));
                }
              
                var questionSubsections = document.getElementsByClassName("webpage-content__section__subsection");
                var resultSection = questionSubsections[questionSubsections.length - 1];

                //remove all children except the "Check Answers"-button
                for (let i = resultSection.childNodes.length - 1; i > 0; i--)
                    resultSection.removeChild(resultSection.childNodes[i]);
                //count the number of correctly answered questions
                var numberCorrect = 0;
                for(result of quizResults)
                    if (result) numberCorrect++;

                resultSection.appendChild(document.createElement("br"));
                resultSection.appendChild(document.createTextNode("You have answered " + numberCorrect + " out of " + questions.length + " questions correctly."));

                for (let i = 0; i < quizResults.length; i++)
                {
                    resultSection.appendChild(document.createElement("br"));
                    resultSection.appendChild(document.createTextNode("Your answer for question " + (i + 1) + " was " + (quizResults[i]?"correct":"incorrect")));
                }

                return quizResults;
            }

            questionSection.addEventListener("onload", renderQuiz());
        </script>

        <noscript>Sorry, your current browsersetup does not support JavaScript!</noscript>

        <footer>
            <hr>    
            <p>Author: Nathan van de Kolk, Joran van de Kolk, Do Toan Nguyen<br>
            <a href = "mailto:d.t.nguyen1@students.uu.nl">d.t.nguyen1@students.uu.nl</a></p> <!-- link that lets the user send a mail to authors of the website -->
        </footer>
    </body>
</html>
        
